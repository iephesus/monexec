(function(t){function n(n){for(var o,s,i=n[0],c=n[1],u=n[2],f=0,d=[];f<i.length;f++)s=i[f],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&d.push(a[s][0]),a[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);l&&l(n);while(d.length)d.shift()();return r.push.apply(r,u||[]),e()}function e(){for(var t,n=0;n<r.length;n++){for(var e=r[n],o=!0,i=1;i<e.length;i++){var c=e[i];0!==a[c]&&(o=!1)}o&&(r.splice(n--,1),t=s(s.s=e[0]))}return t}var o={},a={app:0},r=[];function s(n){if(o[n])return o[n].exports;var e=o[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,s),e.l=!0,e.exports}s.m=t,s.c=o,s.d=function(t,n,e){s.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,n){if(1&n&&(t=s(t)),8&n)return t;if(4&n&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(s.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)s.d(e,o,function(n){return t[n]}.bind(null,o));return e},s.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(n,"a",n),n},s.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},s.p="/ui/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=n,i=i.slice();for(var u=0;u<i.length;u++)n(i[u]);var l=c;r.push([0,"chunk-vendors"]),e()})({0:function(t,n,e){t.exports=e("56d7")},"034f":function(t,n,e){"use strict";e("85ec")},2156:function(t,n,e){},"56d7":function(t,n,e){"use strict";e.r(n);e("e260"),e("e6cf"),e("cca6"),e("a79d");var o=e("2b0e"),a=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[t.machineInfo.Machine?e("h3",{staticClass:"mar10"},[t._v("机器信息:"),e("span",{staticClass:"mar10"},[t._v(t._s(t.machineInfo.Machine))]),e("span",{staticClass:"mar10"},[t._v(t._s(t.machineInfo.Ip))])]):t._e(),e("div",{attrs:{id:"app"}},[t.isLogin?t._e():e("Login"),0!==t.configs.length?e("ShowTable",{attrs:{configs:t.configs}}):t._e()],1)])},r=[],s=(e("d81d"),e("d3b7"),e("3ca3"),e("ddb0"),function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("Table",{attrs:{stripe:"","highlight-row":"",columns:t.monColumns,data:t.svdata},scopedSlots:t._u([{key:"status",fn:function(n){n.row;var o=n.index;return[null===t.svStatusArray[o].running?e("Tag",{attrs:{color:"warning",size:"large"}},[t._v(t._s(t.svStatusArray[o].status))]):t.svStatusArray[o].running?e("Tag",{attrs:{color:"success",size:"large"}},[t._v(t._s(t.svStatusArray[o].status))]):e("Tag",{attrs:{color:"error",size:"large"}},[t._v(t._s(t.svStatusArray[o].status))])]}},{key:"action",fn:function(n){n.row;var o=n.index;return[e("Poptip",{attrs:{confirm:"",transfer:"",title:"确定吗?"},on:{"on-ok":function(n){return t.start(o)}}},[e("Button",{staticStyle:{"margin-right":"5px"},attrs:{disabled:!1!==t.svStatusArray[o].running,loading:t.svStatusArray[o].loading,type:"primary",size:"small"}},[t._v("Start ")])],1),e("Poptip",{attrs:{confirm:"",transfer:"",title:"确定吗?"},on:{"on-ok":function(n){return t.stop(o)}}},[e("Button",{staticStyle:{"margin-right":"5px"},attrs:{disabled:!0!==t.svStatusArray[o].running,loading:t.svStatusArray[o].loading,type:"error",size:"small"}},[t._v("Stop ")])],1),e("Button",{attrs:{type:"info",size:"small"},on:{click:function(n){return t.showlogs(o)}}},[t._v("Log ")])]}}])}),e("Modal",{attrs:{scrollable:"",draggable:"","ok-text":"下载日志",title:"Log Details"},on:{"on-ok":function(n){return t.downloadLog(t.modalSvName)}},model:{value:t.isShowModal,callback:function(n){t.isShowModal=n},expression:"isShowModal"}},[e("p",[t._v(t._s(t.modalSvName))]),e("pre",{staticStyle:{height:"300px","overflow-y":"scroll"},domProps:{textContent:t._s(t.logs)}})])],1)}),i=[],c=(e("99af"),e("4160"),e("a15b"),e("b0c0"),e("159b"),e("2b3d"),{name:"ShowTable",props:{configs:Array},created:function(){var t=this;this.initData(),this.interval=setInterval((function(){t.updateData()}),2e3)},destroyed:function(){clearInterval(this.interval)},data:function(){return{isShowModal:!1,modalSvName:"",logs:"",svStatusArray:[],base:"..",monColumns:[{type:"index",width:60,align:"center"},{title:"服务名",width:200,key:"name",align:"center"},{title:"状态",slot:"status",align:"center",width:150},{title:"命令参数",key:"command",align:"center"},{title:"操作",slot:"action",align:"center",width:250}],svdata:[]}},methods:{initData:function(){this.configs.forEach((function(t){this.svStatusArray.push({name:t.Name,status:function(t){return t.running?"Start":"Stop"}(t),running:t.running,loading:!0}),this.svdata.push({name:t.Name,status:function(t){return t.running?"Start":"Stop"}(t),command:function(t){var n=t.Command,e=null!==t.Args?t.Args.join(" "):"";return n+"  "+e}(t),description:function(t){var n=null!==t.WorkDir?t.WorkDir:"";return"at: "+n}(t)})}),this)},updateData:function(){this.svStatusArray.forEach((function(t,n){this.fetchState(t,n)}),this)},start:function(t){var n=this,e=this.svStatusArray[t],o=this.base;if(!e.running)return e.running=null,e.status="Pending",e.loading=!0,fetch("".concat(o,"/supervisor/")+encodeURIComponent(e.name),{method:"post"}).then((function(o){if(200===o.status)return n.fetchState(e,t);console.warn(o.status,o.statusText)})).catch((function(t){console.error(e.name,t)}))},stop:function(t){var n=this,e=this.svStatusArray[t],o=this.base;if(e.running)return e.running=null,e.status="Pending",e.loading=!0,fetch("".concat(o,"/instance/")+encodeURIComponent(e.name),{method:"post"}).then((function(o){if(204===o.status)return n.fetchState(e,t);console.warn(o.status,o.statusText)})).catch((function(t){console.error(e.name,t)}))},showlogs:function(t){var n=this,e=this.base,o=this.configs[t].Name;fetch("".concat(e,"/supervisor/").concat(o,"/log"),{method:"get"}).then((function(e){404===e.status?(n.isShowModal=!1,n.logs="",n.$Message["error"]({background:!0,content:"配置未设置logFile，找不到文件...",duration:3})):(n.isShowModal=!0,n.modalSvName=n.configs[t].Name,e.text().then((function(t){n.logs=t})))}))},downloadLog:function(t){var n=this,e=this.base;fetch("".concat(e,"/supervisor/").concat(t,"/log"),{method:"get"}).then((function(e){if(404!==e.status){var o=t+".log";e.blob().then((function(t){var n=document.createElement("a");n.style.display="none",n.download=o,n.target="_blank",n.href=URL.createObjectURL(t),document.body.appendChild(n),n.click(),URL.revokeObjectURL(n.href),document.body.removeChild(n)}))}else n.$Message["error"]({background:!0,content:"找不到文件...",duration:3})}))},fetchState:function(t,n){var e=this,o=t.name,a=this.base;return fetch("".concat(a,"/instance/")+encodeURIComponent(o),{method:"get"}).then((function(t){return 404===t.status?{running:!1}:t.json()})).then((function(t){e.svStatusArray[n].running=t.running,t.running?e.svStatusArray[n].status="Start":e.svStatusArray[n].status="Stop",e.svStatusArray[n].loading=!1})).catch((function(t){console.error(o,t)}))}}}),u=c,l=e("2877"),f=Object(l["a"])(u,s,i,!1,null,"85b18094",null),d=f.exports,g=function(){var t=this,n=t.$createElement,o=t._self._c||n;return o("div",[o("Card",{staticClass:"card"},[o("div",{staticStyle:{"text-align":"center"}},[o("img",{staticClass:"loginImage",attrs:{src:e("ed65")}}),o("h3",[t._v("请登录")])])]),o("Form",{ref:"LoginForm",attrs:{model:t.LoginData,rules:t.ruleInline,inline:""}},[o("FormItem",{attrs:{prop:"name"}},[o("Input",{attrs:{type:"text",placeholder:"Username"},model:{value:t.LoginData.name,callback:function(n){t.$set(t.LoginData,"name",n)},expression:"LoginData.name"}},[o("Icon",{attrs:{slot:"prepend",type:"ios-person-outline"},slot:"prepend"})],1)],1),o("FormItem",{attrs:{prop:"password"}},[o("Input",{attrs:{type:"password",placeholder:"Password"},model:{value:t.LoginData.password,callback:function(n){t.$set(t.LoginData,"password",n)},expression:"LoginData.password"}},[o("Icon",{attrs:{slot:"prepend",type:"ios-lock-outline"},slot:"prepend"})],1)],1),o("FormItem",[o("Button",{attrs:{type:"primary"},on:{click:function(n){return t.handleSubmit("LoginForm")}}},[t._v("登录")])],1)],1)],1)},h=[],p={name:"Login",data:function(){return{base:"..",isLogin:!1,LoginData:{name:"",password:""},ruleInline:{name:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},methods:{handleSubmit:function(t){var n=this,e=new FormData;e.append("name",this.LoginData.name),e.append("password",this.LoginData.password);var o=this.base;this.$refs[t].validate((function(t){t&&fetch("".concat(o,"/login"),{method:"post",body:e}).then((function(t){200!==t.status?n.$Message.error("登录错误！"):t.json().then((function(t){n.isLogin=t.loginStatus,sessionStorage.setItem("isLogin",n.isLogin),n.$parent.isLogin=n.isLogin,n.isLogin?(n.$parent.isLoginSuccess(),n.$Message.success(t.info)):n.$Message.error(t.info)}))}))}))}}},m=p,v=(e("8ac9"),Object(l["a"])(m,g,h,!1,null,"6492a049",null)),b=v.exports,S={name:"App",components:{Login:b,ShowTable:d},data:function(){return{configs:[],machineInfo:{},base:"..",isLogin:!1}},created:function(){"true"===sessionStorage.getItem("isLogin")?this.isLogin=!0:this.isLogin=!1,this.isLoginSuccess()},methods:{isLoginSuccess:function(){"true"===sessionStorage.getItem("isLogin")&&(this.getAllSv(),this.getMachineInfo())},getAllSv:function(){var t=this,n=this.base;fetch("".concat(n,"/supervisors"),{method:"get"}).then((function(t){return t.json()})).then((function(t){return Promise.all(t.map((function(t){return fetch("".concat(n,"/supervisor/")+encodeURIComponent(t),{method:"get"}).then((function(t){return t.json()}))})))})).then((function(n){t.configs=n})).catch((function(t){console.error(t)}))},getMachineInfo:function(){var t=this,n=this.base;fetch("".concat(n,"/info"),{method:"get"}).then((function(t){return t.json()})).then((function(n){t.machineInfo=n})).catch((function(t){return console.error(t)}))}}},y=S,w=(e("034f"),Object(l["a"])(y,a,r,!1,null,null,null)),L=w.exports,_=e("f825"),I=e.n(_);e("f8ce");o["default"].config.productionTip=!1,o["default"].use(I.a),new o["default"]({render:function(t){return t(L)}}).$mount("#app")},"85ec":function(t,n,e){},"8ac9":function(t,n,e){"use strict";e("2156")},ed65:function(t,n,e){t.exports=e.p+"img/loginLogo.2ecd3b04.png"}});
//# sourceMappingURL=app.54a9c87e.js.map